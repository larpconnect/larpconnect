<?xml version="1.0"?>
<!DOCTYPE module PUBLIC
          "-//Checkstyle//DTD Checkstyle Configuration 1.3//EN"
          "https://checkstyle.org/dtds/configuration_1_3.dtd">
<module name="Checker">
  <property name="charset" value="UTF-8"/>
  <property name="severity" value="error"/>
  <property name="fileExtensions" value="java"/>
  <module name="SuppressWarningsFilter"/>
  <module name="SuppressionFilter">
    <property name="file" value="${config_loc}/suppressions.xml"/>
  </module>
  <module name="FileTabCharacter">
    <property name="eachLine" value="true"/>
  </module>
  <module name="LineLength">
    <property name="max" value="100"/>
    <property name="ignorePattern"
             value="^package.*|^import.*|href\s*=\s*&quot;[^&quot;]*&quot;|https://"/>
  </module>
  <module name="NewlineAtEndOfFile"/>
  <module name="TreeWalker">
    <module name="AvoidEscapedUnicodeCharacters"/>
    <module name="AvoidStarImport"/>
    <module name="DefaultComesLast"/>
    <module name="FinalClass"/>
    <module name="IllegalCatch">
        <property name="illegalClassNames" value="Exception, Throwable, java.lang.Exception, java.lang.Throwable"/>
    </module>
    <module name="IllegalIdentifierName">
        <property name="format" value="^(?!.*Impl$).*$"/>
        <property name="tokens" value="CLASS_DEF"/>
    </module>
    <module name="MissingCtor"/>
    <module name="PackageDeclaration"/>
    <module name="MagicNumber"/>
    <module name="CyclomaticComplexity">
      <property name="max" value="15"/>
    </module>
    <module name="NPathComplexity"/>
    <module name="RegexpSinglelineJava">
        <property name="format" value="public\s+(?!final|abstract)\s+class"/>
        <property name="message" value="Classes must be declared 'final' or 'abstract'."/>
    </module>
    <module name="RegexpSinglelineJava">
        <property name="format" value="System\.out\.println"/>
        <property name="message" value="Do not use System.out.println; use a logger or directed output instead."/>
    </module>
    <module name="RegexpSinglelineJava">
        <property name="format" value="\.printStackTrace\(\)"/>
        <property name="message" value="Do not use printStackTrace(); use a logger instead."/>
    </module>
    <module name="UnusedLocalVariable"/>
    <module name="UnusedImports"/>
    <module name="RedundantImport"/>
    <module name="IllegalImport">
      <property name="illegalClasses" value="org.junit.jupiter.api.Assertions"/>
      <message key="import.illegal" value="Use AssertJ instead of JUnit assertions."/>
    </module>
    <module name="MethodName">
      <property name="id" value="TestNamingConvention"/>
      <property name="format" value="^[a-z].[a-zA-Z0-9]+\_[a-zA-Z0-9]+(\_[a-zA-Z0-9]+)?$"/>
    </module>
    <module name="SuppressionXpathSingleFilter">
      <property name="id" value="TestNamingConvention"/>
      <property name="query" value="//METHOD_DEF[not(.//ANNOTATION//IDENT[@text='Test'])]/IDENT"/>
    </module>
    <module name="MatchXpath">
      <property name="query" value="//METHOD_DEF[.//ANNOTATION//IDENT[@text='Test']]/IDENT[starts-with(@text, 'test')]"/>
      <message key="matchxpath.match" value="Tests must not be named test.*()"/>
    </module>
    <module name="MatchXpath">
      <property name="query" value="//CLASS_DEF[EXTENDS_CLAUSE/IDENT[@text='AbstractModule'] and .//METHOD_CALL/IDENT[@text='install'] and (.//METHOD_CALL/IDENT[@text='bind'] or .//ANNOTATION/IDENT[@text='Provides'])]"/>
      <message key="matchxpath.match" value="Guice modules cannot contain both install() and bind() calls or @Provides methods. Split them into separate modules."/>
    </module>
    <module name="MatchXpath">
      <property name="query" value="//CLASS_DEF[EXTENDS_CLAUSE/IDENT[@text='AbstractModule']]//METHOD_CALL[(IDENT[@text='bind'] or DOT/IDENT[@text='bind']) and parent::EXPR]"/>
      <message key="matchxpath.match" value="bind() must be followed by another method call (e.g., .to(), .toInstance(), .toProvider())."/>
    </module>
    <module name="MatchXpath">
      <property name="query" value="//METHOD_CALL/DOT/IDENT[@text='asEagerSingleton']"/>
      <message key="matchxpath.match" value="asEagerSingleton() is forbidden. Use .in(com.google.inject.Scopes.SINGLETON) instead if needed, but ensure you bind .to() something."/>
    </module>
  </module>
</module>
